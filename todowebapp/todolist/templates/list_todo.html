{% extends "master.html" %}
{% block content %}
    <table class="table my-4">
      <thead>
        <tr>
          {% for field in fields %}
          <th scope="col">{{ field }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for task in tasks %}
        <tr>
          <td class="text-center" style="color: dodgerblue">
            {% if task.status == 0 %}
            <i class="bi bi-square"></i>
            {% elif task.status == 1 %}
            <i class="bi bi-square-half"></i>
            {% elif task.status == 2 %}
            <i class="bi bi-square-fill"></i>
            {% endif %}
          </td>
          
          <td>{{ task.title }}</td>
          
          <td class="text-center">
            {% if task.priority == 0 %}
              <span class="badge text-bg-green" style="background-color: green;">{{ task.get_priority_display }}</span>
            {% elif task.priority == 1 %}
              <span class="badge text-bg-orange" style="background-color: orange; color: white;">{{ task.get_priority_display }}</span>
            {% elif task.priority == 2 %}
              <span class="badge text-bg-red" style="background-color: red;">{{ task.get_priority_display }}</span>
            {% elif task.priority == 3 %}
              <span class="badge text-bg-purple" style="background-color: purple;">{{ task.get_priority_display }}</span>
            {% else %}
              {{ task.get_priority_display }}
            {% endif %}
          </td>

          <td>{{ task.due_date|default:"—" }}</td>
          <td>{{ task.comment|default:"—" }}</td>
          <td>{{ task.delivered_to|default:"—" }}</td>
          <td>{{ task.created_at }}</td>
          <td>{{ task.updated_at }}</td>
        </tr>
        {% endfor %}
        
        <tr class="table">
          <td colspan="{{ fields|length }}" class="text-center">
            <button type="button" class="btn" data-bs-toggle="modal" data-bs-target="#newTaskModal">
              <i class="bi bi-plus-circle"></i> Add new task
            </button>
          </td>
        </tr>
        
      </tbody>
    </table>

    <!-- Modal -->
    <div class="modal fade" id="newTaskModal" tabindex="-1" aria-labelledby="newTaskModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border rounded p-2 bg-light" style="font-size: 0.9rem;">
          
          <div class="modal-header">
            <h5 class="modal-title" id="newTaskModalLabel">New Task</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <form method="post">
            <div class="modal-body">
              {% csrf_token %}
              {{ form.as_p }}
            </div>

            <div class="modal-footer d-flex justify-content-center">
              <button type="submit" class="btn btn-success btn-sm">
                <i class="bi bi-check-circle"></i> Save
              </button>
              <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">
                <i class="bi bi-x-circle"></i> Cancel
              </button>
            </div>
          </form>

        </div>
      </div>
    </div>


{% endblock %}
{% block css %}
    {{ block.super}} {# richiama il blocco del padre #}
{% endblock %}
{% block javascript %}
    {{ block.super}} {# richiama il blocco del padre #}
{% endblock %}